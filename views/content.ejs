<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add New Content</title>
    <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/add-content.css">
</head> 
<body>
  <header class="top-menu">
        <%- include('partials/header') %>
  </header>
  <main class="add-content-page">
    <h1>Add New Content</h1>

    <% if (success) { %>
    <div class="banner success">
     Content uploaded successfully!
    </div>
  <% } %>

  <% if (error) { %>
    <div class="banner error">
       There was an error uploading the content. Please try again.
    </div>
  <% } %>

<form class="add-content-form" action="/content" method="POST" enctype="multipart/form-data">
  <div class="form-row">
    <label>Content Type</label>
    <div class="radio-group" style="display:flex; gap:12px; align-items:center;">
      <label style="display:inline-flex; align-items:center; gap:6px;">
        <input type="radio" name="type" value="movie" required>
        Movie
      </label>
      <label style="display:inline-flex; align-items:center; gap:6px;">
        <input type="radio" name="type" value="series">
        Series
      </label>
       <label style="display:inline-flex; align-items:center; gap:6px;">
        <input type="radio" name="type" value="episode">
        Episode
      </label>
    </div>
  </div>
  
  <div class="form-row common-field">
    <label for="title">Title</label>
    <input type="text" id="title" name="title" required>
  </div>

  <div class="form-row common-field">
    <label for="description">Description</label>
    <textarea id="description" name="description" required></textarea>
  </div>

  <!-- MOVIE / SERIES ONLY -->
  <div class="form-row movie-series-field">
    <label for="releaseYear">Year</label>
    <input type="number" id="releaseYear" name="releaseYear" min="1800" max="2100">
  </div>

  <div class="form-row movie-series-field">
    <label>Genre</label>
    <div class="checkbox-group">
      <% if (Array.isArray(allGenres) && allGenres.length) { %>
        <% allGenres.forEach(function(genre) { %>
          <label><input type="checkbox" name="genre" value="<%= genre %>"> <%= genre %></label>
        <% }); %>
      <% } else { %>
        <p>No genres available.</p>
      <% } %>
    </div>
  </div>

  <div class="form-row movie-series-field">
    <label for="actors">Actors (comma separated)</label>
    <input type="text" id="actors" name="cast">
  </div>

  <div class="form-row movie-series-field">
    <label for="director">Director</label>
    <input type="text" id="director" name="director">
  </div>

  <!-- EPISODE ONLY -->
  <div id="episode-fields" style="display:none;">
  <div class="form-row">
    <label for="seriesSelect">Select Series</label>
    <select id="seriesSelect" name="series">
      <option value="">Select Series</option>
      <% if (Array.isArray(series) && series.length) { %>
        <% series.forEach(function(s) { %>
            <option value="<%= s._id %>"><%= s.title %></option>
        <% }); %>
      <% } else { %>
        <option value="">No series available</option>
      <% } %>
    </select>
  </div>

    <div class="form-row">
      <label for="seasonNumber">Season Number</label>
      <input type="number" id="seasonNumber" name="seasonNumber" min="1">
    </div>

    <div class="form-row">
      <label for="episodeNumber">Episode Number</label>
      <input type="number" id="episodeNumber" name="episodeNumber" min="1">
    </div>
  </div>

  <div class="form-row common-field">
    <label for="coverImageFile">Cover Image</label>
    <input type="file" id="coverImageFile" name="coverImageFile" accept="image/*">
  </div>

  <div class="form-row common-field">
    <label for="videoFile">Video File</label>
    <input type="file" id="videoFile" name="videoFile" accept="video/*">
  </div>

  <div class="form-row common-field">
    <button type="submit">Add Content</button>
  </div>
</form>

  </main>
<script>
  window.series = <%- JSON.stringify(series || []) %>;
</script>
<script src="/js/add-content.js"> </script>

</body>
</html>